<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CashBlocks DeFi Protocol</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            base: { DEFAULT: '#06080f', light: '#0b0f1a' },
            surface: { DEFAULT: '#0f1322', 2: '#151b2e', 3: '#1a2340' },
            accent: { DEFAULT: '#4f8fff', deep: '#3366ff' },
            txt: { DEFAULT: '#e8ecf4', 2: '#a0aec0', 3: '#64748b' },
            ok: '#00d68f',
            err: '#ff5c5c',
            warn: '#ffb84d',
            vault: '#a78bfa',
            timestate: '#22d3ee',
            oracle: '#f87171',
            tokengate: '#fbbf24',
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
            mono: ['JetBrains Mono', 'SF Mono', 'monospace'],
          },
          maxWidth: { container: '1360px' },
        },
      },
    }
  </script>

  <!-- App.js bridge: all dynamically-referenced CSS classes -->
  <style type="text/tailwindcss">
    @layer components {
      /* === SCENARIO PANEL / TAB VISIBILITY === */
      .scenario-panel { @apply hidden; }
      .scenario-panel.active { @apply block; animation: panelIn 0.25s ease; }
      .lending-tab-content { @apply hidden bg-surface border border-white/[0.06] rounded-xl p-5 mt-3; }
      .lending-tab-content.active { @apply block; animation: tabSlideIn 0.25s ease; }

      /* === ACTIVE STATES (JS toggles) === */
      .sidebar-item.active { @apply bg-surface-2 text-txt; border-color: rgba(255,255,255,0.1); box-shadow: 0 1px 3px rgba(0,0,0,0.3), 0 4px 16px rgba(0,0,0,0.2); }
      .nav-link.active { @apply text-txt bg-surface-2; }
      .mode-btn.active { @apply bg-accent text-white; box-shadow: 0 1px 4px rgba(79,143,255,0.3); }
      .mode-btn.active[data-mode="chipnet"] { background: var(--green); box-shadow: 0 1px 4px rgba(0,214,143,0.3); }
      .code-tab.active { @apply text-accent bg-surface-2 font-semibold; }
      .lending-tab.active { @apply text-white font-semibold; background: rgba(79,143,255,0.18); box-shadow: 0 1px 4px rgba(79,143,255,0.15); }
      .lending-tab.active::after { display: none; }
      .lending-tab.active svg { opacity: 1; color: var(--accent); }
      .lending-tab.disabled { @apply opacity-35 cursor-not-allowed; pointer-events: none; }
      .pct-btn.active { color: var(--accent); border-color: var(--accent); background: rgba(79,143,255,0.1); }

      /* === TOAST SYSTEM === */
      .toast { @apply flex items-center gap-2.5 rounded-lg pointer-events-auto; padding: 0.75rem 1rem; background: var(--surface2); border: 1px solid rgba(255,255,255,0.1); box-shadow: 0 4px 24px rgba(0,0,0,0.4), 0 12px 48px rgba(0,0,0,0.3); backdrop-filter: blur(12px); animation: toastIn 0.35s cubic-bezier(0.16, 1, 0.3, 1); }
      .toast-out { animation: toastOut 0.3s ease forwards; }
      .toast-icon { @apply w-7 h-7 rounded-full flex items-center justify-center shrink-0 text-xs font-extrabold; }
      .toast-success .toast-icon { background: rgba(0,214,143,0.15); color: var(--green); }
      .toast-error .toast-icon { background: rgba(255,92,92,0.15); color: var(--red); }
      .toast-info .toast-icon { background: rgba(79,143,255,0.15); color: var(--accent); }
      .toast-body { @apply flex-1 min-w-0; }
      .toast-title { @apply text-sm font-semibold leading-tight; color: var(--text); }
      .toast-msg { @apply text-xs mt-px; color: var(--text3); }

      /* === HEALTH BADGE === */
      .health-badge { @apply inline-flex items-center gap-2 px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider; }
      .health-healthy { background: rgba(0,214,143,0.1); color: var(--green); border: 1px solid rgba(0,214,143,0.25); }
      .health-moderate { background: rgba(255,184,77,0.1); color: var(--amber); border: 1px solid rgba(255,184,77,0.25); }
      .health-critical { background: rgba(255,92,92,0.1); color: var(--red); border: 1px solid rgba(255,92,92,0.25); }

      /* === SERVER STATUS === */
      .server-online { color: var(--green) !important; border-color: rgba(0,214,143,0.2) !important; }
      .server-online .badge-dot { background: var(--green); box-shadow: 0 0 6px var(--green); }
      .server-offline { color: var(--red) !important; border-color: rgba(255,77,77,0.2) !important; }
      .server-offline .badge-dot { background: var(--red); box-shadow: 0 0 6px var(--red); }
      .badge-chipnet-active { color: var(--green) !important; border-color: rgba(0,214,143,0.3) !important; }
      .badge-chipnet-active .badge-dot { background: var(--green); box-shadow: 0 0 8px var(--green); animation: chipnetPulse 2s ease-in-out infinite; }

      /* === STEP / TIMELINE === */
      .step { @apply flex gap-3 rounded-lg; padding: 0.75rem 1rem; background: var(--bg2); border: 1px solid rgba(255,255,255,0.06); animation: stepIn 0.35s ease; transition: border-color 0.2s; }
      .step:hover { border-color: rgba(255,255,255,0.1); }
      .step.info { border-left: 3px solid var(--accent); }
      .step.blocked { border-left: 3px solid var(--red); background: rgba(255,92,92,0.08); }
      .step.success { border-left: 3px solid var(--green); background: rgba(0,214,143,0.08); }
      .step-icon { @apply w-[30px] h-[30px] rounded-full flex items-center justify-center text-xs font-bold shrink-0; }
      .step-icon.info { background: rgba(79,143,255,0.12); color: var(--accent); }
      .step-icon.blocked { background: rgba(255,92,92,0.12); color: var(--red); }
      .step-icon.success { background: rgba(0,214,143,0.12); color: var(--green); }
      .step-body { @apply flex-1 min-w-0; }
      .step-title { @apply font-semibold text-sm leading-relaxed; }
      .step-details { @apply grid gap-x-3 gap-y-0.5 mt-1.5 text-xs; grid-template-columns: auto 1fr; }
      .step-key { color: var(--text3); @apply font-medium; }
      .step-val { color: var(--text2); @apply font-mono text-[0.6875rem] break-all; }
      .step-primitives { @apply flex gap-1 mt-1.5; }

      /* === PRIM TAGS (dynamic) === */
      .prim-tag { @apply px-2 py-0.5 rounded text-[0.6875rem] font-semibold uppercase tracking-wide; }
      .prim-tag.vault { background: rgba(167,139,250,0.1); color: var(--vault); border: 1px solid rgba(167,139,250,0.2); }
      .prim-tag.timestate, .prim-tag.time-state { background: rgba(34,211,238,0.1); color: var(--timestate); border: 1px solid rgba(34,211,238,0.2); }
      .prim-tag.oracle, .prim-tag.oracleproof { background: rgba(248,113,113,0.1); color: var(--oracle); border: 1px solid rgba(248,113,113,0.2); }
      .prim-tag.tokengate { background: rgba(251,191,36,0.1); color: var(--tokengate); border: 1px solid rgba(251,191,36,0.2); }

      /* === SUMMARY === */
      .summary-grid { @apply grid gap-3; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); }
      .summary-item { @apply rounded-lg p-3.5; background: var(--bg2); border: 1px solid rgba(255,255,255,0.06); }
      .summary-label { @apply text-[0.6875rem] uppercase tracking-wide font-medium; color: var(--text3); }
      .summary-value { @apply text-[0.9375rem] font-bold font-mono mt-0.5; color: var(--text); }
      .exec-time { @apply text-xs mt-3 text-right font-mono; color: var(--text3); }

      /* === CODE VIEWER === */
      .code-header { @apply flex justify-between items-center px-5 py-2.5; background: var(--surface2); border-bottom: 1px solid rgba(255,255,255,0.06); }
      .code-title { @apply text-sm font-semibold; color: var(--text2); }
      .copy-btn { @apply px-2.5 py-1 rounded text-[0.6875rem] font-medium cursor-pointer transition-all; background: var(--surface); border: 1px solid rgba(255,255,255,0.1); color: var(--text3); font-family: var(--font); }
      .copy-btn:hover { color: var(--accent); border-color: rgba(79,143,255,0.3); }
      .code-block { @apply px-5 py-5 font-mono text-sm leading-7 overflow-x-auto; color: #c9d6e6; tab-size: 2; }
      .spinner { @apply inline-block w-3.5 h-3.5 rounded-full mr-1.5 align-middle; border: 2px solid rgba(255,255,255,0.2); border-top-color: #fff; animation: spin 0.6s linear infinite; }

      /* === POOL BROWSER === */
      .pool-browser-item { @apply flex items-center justify-between gap-4 rounded-xl transition-all; padding: 0.85rem 1rem; background: var(--bg2); border: 1px solid rgba(255,255,255,0.06); }
      .pool-browser-item:hover { border-color: rgba(79,143,255,0.15); background: rgba(79,143,255,0.03); box-shadow: 0 2px 8px rgba(0,0,0,0.2); }
      .pool-browser-info { @apply flex-1 min-w-0; }
      .pool-browser-owner { @apply text-sm font-bold mb-1; color: var(--text); }
      .pool-browser-stats { @apply flex gap-3 text-[0.7rem] font-mono; color: var(--text3); }
      .pool-browser-util { @apply font-semibold; color: var(--accent); }
      .pool-browser-join { @apply px-4 py-2 rounded-lg text-xs font-semibold cursor-pointer transition-all whitespace-nowrap shrink-0; background: linear-gradient(135deg, rgba(79,143,255,0.15), rgba(79,143,255,0.08)); border: 1px solid rgba(79,143,255,0.3); color: var(--accent); font-family: var(--font); }
      .pool-browser-join:hover { background: linear-gradient(135deg, rgba(79,143,255,0.25), rgba(79,143,255,0.15)); border-color: var(--accent); box-shadow: 0 2px 8px rgba(79,143,255,0.2); transform: translateY(-1px); }

      /* === LOAN RESULT === */
      .loan-result { @apply mt-4 rounded-xl flex items-start gap-3 flex-wrap; padding: 1rem 1.25rem; animation: slideUp 0.3s ease; }
      .loan-result.loan-success { background: rgba(0,214,143,0.08); border: 1px solid rgba(0,214,143,0.3); box-shadow: 0 2px 12px rgba(0,214,143,0.1); }
      .loan-result.loan-rejected { background: rgba(255,92,92,0.08); border: 1px solid rgba(255,92,92,0.3); box-shadow: 0 2px 12px rgba(255,92,92,0.1); }
      .loan-result-icon { @apply text-lg font-extrabold shrink-0 leading-none; }
      .loan-success .loan-result-icon { color: var(--green); }
      .loan-rejected .loan-result-icon { color: var(--red); }
      .loan-result-msg { @apply text-sm flex-1 min-w-0 break-all; color: var(--text); }

      /* === LOAN ATTEMPTS === */
      .loan-attempt { @apply flex items-center gap-3 rounded-xl text-xs; padding: 0.65rem 0.85rem; background: var(--bg2); border: 1px solid rgba(255,255,255,0.06); transition: border-color 0.2s; }
      .loan-attempt:hover { border-color: rgba(255,255,255,0.1); }
      .loan-attempt.attempt-success { border-left: 3px solid var(--green); background: rgba(0,214,143,0.04); }
      .loan-attempt.attempt-rejected { border-left: 3px solid var(--red); background: rgba(255,92,92,0.04); }
      .attempt-status { @apply font-extrabold; }
      .attempt-success .attempt-status { color: var(--green); }
      .attempt-rejected .attempt-status { color: var(--red); }
      .attempt-amount { @apply font-mono font-semibold; color: var(--text); }
      .attempt-score { color: var(--text2); }
      .attempt-detail { @apply font-mono text-[0.6875rem] overflow-hidden text-ellipsis whitespace-nowrap flex-1 min-w-0; color: var(--text3); }

      /* === RECENT ACTIVITY === */
      .recent-item { @apply flex items-center gap-3 rounded-lg text-xs; padding: 0.6rem 0.85rem; background: var(--bg2); border: 1px solid rgba(255,255,255,0.06); animation: stepIn 0.3s ease; transition: border-color 0.2s; }
      .recent-item:hover { border-color: rgba(255,255,255,0.1); background: rgba(255,255,255,0.02); }
      .recent-status-dot { @apply w-2 h-2 rounded-full shrink-0; }
      .recent-status-dot.dot-success { background: var(--green); box-shadow: 0 0 4px var(--green); }
      .recent-status-dot.dot-rejected { background: var(--red); box-shadow: 0 0 4px var(--red); }
      .recent-amount { @apply font-mono font-semibold; color: var(--text); }
      .recent-time { @apply text-[0.65rem] ml-auto; color: var(--text3); }

      /* === HISTORY TABLE === */
      .history-row td { @apply px-4 py-3; border-bottom: 1px solid rgba(255,255,255,0.03); }
      .history-row:nth-child(even) td { background: rgba(255,255,255,0.015); }
      .history-row:hover td { background: rgba(79,143,255,0.06) !important; }
      .history-status { @apply px-3 py-1 rounded-full text-[0.6875rem] font-semibold uppercase inline-flex items-center gap-1; }
      .status-success { background: rgba(0,214,143,0.1); color: var(--green); border: 1px solid rgba(0,214,143,0.25); }
      .status-rejected { background: rgba(255,92,92,0.1); color: var(--red); border: 1px solid rgba(255,92,92,0.25); }
      .txid-cell { @apply flex items-center gap-1.5; }
      .txid-mono { @apply font-mono text-[0.7rem]; color: var(--text3); }
      .copy-txid-btn { @apply px-2 py-1 rounded-md text-[0.65rem] cursor-pointer shrink-0 leading-none transition-all; background: var(--surface2); border: 1px solid rgba(255,255,255,0.1); color: var(--text3); font-family: var(--font); }
      .copy-txid-btn:hover { color: var(--accent); border-color: rgba(79,143,255,0.3); background: rgba(79,143,255,0.06); }
      .text-muted { color: var(--text3); }

      /* === INPUT VALIDATION === */
      .input-error { border-color: var(--red) !important; box-shadow: 0 0 0 3px rgba(255,92,92,0.12) !important; }
      .input-valid { border-color: var(--green) !important; box-shadow: 0 0 0 3px rgba(0,214,143,0.12) !important; }

      /* === EXPLORER LINK === */
      .explorer-link { @apply inline-flex items-center gap-1.5 text-xs font-medium no-underline transition-all py-0.5; color: var(--green); }
      .explorer-link:hover { color: #22d3ee; text-decoration: underline; }
      .explorer-link svg { @apply shrink-0; }

      /* === WALLET === */
      .wallet-addr-value { @apply text-xs font-mono break-all leading-relaxed select-all cursor-text; color: var(--text); }
      .wallet-hint { @apply text-sm; color: var(--text3); }
      #wallet-trigger.wallet-active { @apply border-ok/30 text-ok; box-shadow: 0 0 8px rgba(0,214,143,0.15); }

      /* === VALUE PULSE === */
      .value-pulse { animation: valuePulse 0.4s ease; }
    }
  </style>

  <!-- Custom CSS: variables, keyframes, complex components -->
  <style>
    :root {
      --bg: #06080f; --bg2: #0b0f1a;
      --surface: #0f1322; --surface2: #151b2e; --surface3: #1a2340;
      --border: rgba(255,255,255,0.06); --border2: rgba(255,255,255,0.10);
      --text: #e8ecf4; --text2: #a0aec0; --text3: #64748b;
      --accent: #4f8fff; --accent2: #3366ff;
      --green: #00d68f; --green-bg: rgba(0,214,143,0.08);
      --red: #ff5c5c; --red-bg: rgba(255,92,92,0.08);
      --amber: #ffb84d;
      --vault: #a78bfa; --vault-bg: rgba(167,139,250,0.10);
      --timestate: #22d3ee; --timestate-bg: rgba(34,211,238,0.10);
      --oracle: #f87171; --oracle-bg: rgba(248,113,113,0.10);
      --tokengate: #fbbf24; --tokengate-bg: rgba(251,191,36,0.10);
      --radius: 12px; --radius-sm: 8px; --radius-xs: 6px;
      --font: 'Inter', -apple-system, system-ui, sans-serif;
      --mono: 'JetBrains Mono', 'SF Mono', 'Cascadia Code', monospace;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; scroll-padding-top: 84px; }
    body { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }

    /* Keyframes */
    @keyframes panelIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes stepIn { from { opacity: 0; transform: translateX(-8px); } to { opacity: 1; transform: translateX(0); } }
    @keyframes toastIn { from { opacity: 0; transform: translateX(100%) scale(0.95); } to { opacity: 1; transform: translateX(0) scale(1); } }
    @keyframes toastOut { from { opacity: 1; transform: translateX(0) scale(1); } to { opacity: 0; transform: translateX(100%) scale(0.95); } }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes valuePulse { 0% { transform: scale(1); } 50% { transform: scale(1.06); } 100% { transform: scale(1); } }
    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes chipnetPulse { 0%, 100% { box-shadow: 0 0 6px var(--green); } 50% { box-shadow: 0 0 14px var(--green); } }
    @keyframes tabSlideIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes checkCircle { to { stroke-dashoffset: 0; } }
    @keyframes checkStroke { to { stroke-dashoffset: 0; } }
    @keyframes slideUp { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 5px; height: 5px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--surface3); border-radius: 10px; }

    /* Hero gradient text */
    .hero-title-gradient { background: linear-gradient(135deg, #fff 20%, var(--text2) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .stat-value-gradient { background: linear-gradient(135deg, #fff, var(--text2)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .balance-gradient { background: linear-gradient(135deg, var(--green), #22d3ee); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }

    /* Ring Chart */
    .ring-bg { fill: none; stroke: var(--surface3); stroke-width: 8; }
    .ring-fill { fill: none; stroke: var(--green); stroke-width: 8; stroke-linecap: round; transition: stroke-dashoffset 0.8s cubic-bezier(0.4, 0, 0.2, 1), stroke 0.4s ease; }

    /* Score Slider */
    .score-slider { -webkit-appearance: none; appearance: none; width: 100%; height: 12px; border-radius: 100px; background: linear-gradient(90deg, var(--red) 0%, #ff8c42 20%, var(--amber) 40%, #84cc16 65%, var(--green) 100%); outline: none; cursor: pointer; box-shadow: inset 0 1px 3px rgba(0,0,0,0.3); }
    .score-slider::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 28px; height: 28px; border-radius: 50%; background: #fff; border: 3px solid #fff; cursor: pointer; box-shadow: 0 2px 12px rgba(0,0,0,0.5), 0 0 0 4px rgba(255,255,255,0.1); transition: transform 0.15s, box-shadow 0.15s; }
    .score-slider::-webkit-slider-thumb:hover { transform: scale(1.15); box-shadow: 0 2px 16px rgba(0,0,0,0.6), 0 0 0 6px rgba(255,255,255,0.15); }
    .score-slider::-moz-range-thumb { width: 28px; height: 28px; border-radius: 50%; background: #fff; border: 3px solid #fff; cursor: pointer; box-shadow: 0 2px 12px rgba(0,0,0,0.5), 0 0 0 4px rgba(255,255,255,0.1); }

    /* Score Tooltip */
    .score-tooltip { position: absolute; top: -32px; padding: 0.2rem 0.55rem; border-radius: 6px; font-size: 0.75rem; font-weight: 800; font-family: var(--mono); color: #fff; white-space: nowrap; pointer-events: none; transform: translateX(-50%); transition: left 0.05s ease-out; z-index: 5; }
    .score-tooltip::after { content: ''; position: absolute; bottom: -4px; left: 50%; transform: translateX(-50%); border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 5px solid currentColor; }
    .score-tooltip.score-low { background: var(--red); color: var(--red); }
    .score-tooltip.score-low::after { border-top-color: var(--red); }
    .score-tooltip.score-med { background: var(--amber); color: var(--amber); }
    .score-tooltip.score-med::after { border-top-color: var(--amber); }
    .score-tooltip.score-high { background: var(--green); color: var(--green); }
    .score-tooltip.score-high::after { border-top-color: var(--green); }
    .score-tooltip span { color: #fff; }

    /* Checkmark Animation */
    .checkmark-svg { display: block; margin: 0.75rem auto; width: 56px; height: 56px; }
    .checkmark-circle { stroke: var(--green); stroke-width: 2; fill: none; stroke-dasharray: 166; stroke-dashoffset: 166; animation: checkCircle 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards; }
    .checkmark-check { stroke: var(--green); stroke-width: 3; stroke-linecap: round; stroke-linejoin: round; fill: none; stroke-dasharray: 48; stroke-dashoffset: 48; animation: checkStroke 0.4s cubic-bezier(0.65, 0, 0.45, 1) 0.4s forwards; }

    /* Loading Overlay */
    .loading-overlay { position: absolute; inset: 0; background: rgba(6,8,15,0.7); backdrop-filter: blur(8px); border-radius: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 1rem; z-index: 10; animation: fadeIn 0.2s ease; }
    .loading-ring { width: 44px; height: 44px; border: 3px solid rgba(79,143,255,0.15); border-top-color: var(--accent); border-radius: 50%; animation: spin 0.8s linear infinite; }

    /* Glassmorphism Card */
    .glass-card { background: rgba(15,19,34,0.8); backdrop-filter: blur(32px) saturate(180%); -webkit-backdrop-filter: blur(32px) saturate(180%); border: 1px solid rgba(255,255,255,0.08); border-radius: 20px; padding: 1.75rem; position: relative; box-shadow: 0 4px 32px rgba(0,0,0,0.5), 0 16px 64px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.06); transition: box-shadow 0.3s ease; }
    .glass-card::before { content: ''; position: absolute; top: 0; left: 20px; right: 20px; height: 2px; background: linear-gradient(90deg, transparent, var(--accent), var(--vault), transparent); border-radius: 2px; opacity: 0.6; }
    .glass-card:hover { box-shadow: 0 4px 32px rgba(0,0,0,0.5), 0 20px 72px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.06); }

    /* Primitive Card Hover */
    .prim-card-line::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; opacity: 0; transition: opacity 0.25s; }
    .prim-card-line:hover::before { opacity: 1; }
    .prim-card-line.line-vault::before { background: linear-gradient(90deg, var(--vault), transparent); }
    .prim-card-line.line-timestate::before { background: linear-gradient(90deg, var(--timestate), transparent); }
    .prim-card-line.line-oracle::before { background: linear-gradient(90deg, var(--oracle), transparent); }
    .prim-card-line.line-tokengate::before { background: linear-gradient(90deg, var(--tokengate), transparent); }

    /* Button micro-interactions */
    .btn-press:active { transform: scale(0.98) !important; }

    /* Score threshold marker */
    .score-threshold { position: absolute; top: 0; width: 2px; height: 100%; background: var(--red); pointer-events: none; opacity: 0.7; }

    /* Wallet dropdown */
    .wallet-dropdown {
      position: absolute;
      top: 60px;
      left: 0;
      right: 0;
      z-index: 45;
      background: rgba(11, 15, 26, 0.97);
      backdrop-filter: blur(24px) saturate(180%);
      -webkit-backdrop-filter: blur(24px) saturate(180%);
      border-bottom: 1px solid rgba(255,255,255,0.06);
      box-shadow: 0 8px 32px rgba(0,0,0,0.5), 0 2px 8px rgba(0,0,0,0.3);
      max-height: 0;
      overflow: hidden;
      opacity: 0;
      transition: max-height 0.3s ease, opacity 0.25s ease;
      pointer-events: none;
    }
    .wallet-dropdown.wallet-open {
      max-height: 500px;
      opacity: 1;
      pointer-events: auto;
      overflow-y: auto;
    }

    @media (max-width: 768px) {
      .glass-card { padding: 1.25rem; border-radius: 16px; }
    }
    @media (max-width: 640px) {
      #wallet-trigger-label { display: none; }
      #wallet-trigger-balance { display: none !important; }
    }
  </style>
</head>
<body class="bg-base text-txt font-sans leading-relaxed min-h-screen">

  <!-- ── Sticky Header ── -->
  <header class="sticky top-0 z-50 h-[60px] border-b border-white/[0.06]" style="background:rgba(6,8,15,0.82);backdrop-filter:blur(20px) saturate(180%);-webkit-backdrop-filter:blur(20px) saturate(180%)">
    <div class="max-w-container mx-auto px-4 md:px-8 h-full flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-9 h-9 rounded-[10px] flex items-center justify-center shrink-0" style="background:linear-gradient(135deg,var(--accent),#7c3aed)">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><rect x="2" y="6" width="8" height="12" rx="2" fill="#fff" opacity="0.9"/><rect x="14" y="6" width="8" height="12" rx="2" fill="#fff" opacity="0.5"/><rect x="8" y="3" width="8" height="18" rx="2" fill="#fff" opacity="0.7"/></svg>
        </div>
        <div class="flex items-center gap-2">
          <span class="text-base font-bold tracking-tight">CashBlocks</span>
          <span class="w-1 h-1 rounded-full bg-txt-3"></span>
          <span class="text-sm text-txt-2 font-medium">DeFi Protocol</span>
        </div>
      </div>
      <nav class="hidden md:flex gap-1">
        <a href="#scenarios" class="nav-link active px-3.5 py-1.5 rounded-md text-sm font-medium text-txt-3 no-underline transition-all hover:text-txt-2 hover:bg-surface">Scenarios</a>
        <a href="#primitives" class="nav-link px-3.5 py-1.5 rounded-md text-sm font-medium text-txt-3 no-underline transition-all hover:text-txt-2 hover:bg-surface">Primitives</a>
        <a href="#sdk" class="nav-link px-3.5 py-1.5 rounded-md text-sm font-medium text-txt-3 no-underline transition-all hover:text-txt-2 hover:bg-surface">SDK</a>
      </nav>
      <div class="flex gap-2 items-center">
        <button type="button" id="wallet-trigger" class="relative flex items-center gap-2 px-3 py-1.5 rounded-full text-[0.75rem] font-semibold bg-surface border border-white/10 text-txt-2 cursor-pointer transition-all hover:border-ok/30 hover:text-ok">
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12V7H5a2 2 0 010-4h14v4"/><path d="M3 5v14a2 2 0 002 2h16v-5"/><path d="M18 12a2 2 0 100 4 2 2 0 000-4z"/></svg>
          <span id="wallet-trigger-label">Wallet</span>
          <span id="wallet-trigger-balance" class="hidden font-mono text-ok text-[0.7rem]"></span>
          <svg class="w-3 h-3 transition-transform wallet-chevron" viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 5l3 3 3-3"/></svg>
        </button>
        <div class="flex bg-surface border border-white/10 rounded-full p-0.5 gap-0.5">
          <button class="mode-btn active px-3 py-1 border-none rounded-full text-[0.6875rem] font-semibold cursor-pointer transition-all text-txt-3 bg-transparent" data-mode="chipnet">Chipnet</button>
        </div>
        <span class="badge badge-net flex items-center gap-1.5 px-2.5 py-1 rounded-full text-[0.6875rem] font-semibold bg-surface border border-ok/20 text-ok" id="badge-net">
          <span class="badge-dot w-1.5 h-1.5 rounded-full bg-ok" style="box-shadow:0 0 6px var(--green)"></span>
          <span id="badge-net-text">Testnet</span>
        </span>
        <span class="badge badge-server flex items-center gap-1.5 px-2.5 py-1 rounded-full text-[0.6875rem] font-semibold bg-surface border border-white/10 text-txt-3 transition-all" id="badge-server">
          <span class="badge-dot w-1.5 h-1.5 rounded-full bg-ok" id="server-dot" style="box-shadow:0 0 6px var(--green)"></span>
          <span id="server-status-text">Checking...</span>
        </span>
        <span class="hidden sm:flex items-center px-2.5 py-1 rounded-full text-[0.6875rem] font-semibold bg-surface border border-accent/20 text-accent">v1.0</span>
      </div>
    </div>
  </header>

  <!-- ── Wallet Dropdown Panel ── -->
  <div id="wallet-section" class="wallet-dropdown">
    <div class="max-w-container mx-auto px-4 md:px-8 py-4">
      <div class="flex items-center justify-between mb-3">
        <div class="flex items-center gap-2">
          <span class="text-sm font-bold tracking-tight">Chipnet Wallet</span>
          <span class="flex items-center gap-1 px-2 py-0.5 rounded-full text-[0.6rem] font-semibold bg-ok/[0.08] border border-ok/20 text-ok">
            <span class="w-1 h-1 rounded-full bg-ok" style="box-shadow:0 0 4px var(--green)"></span>
            Live
          </span>
        </div>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
        <!-- Keys Card -->
        <div class="bg-surface border border-white/[0.06] rounded-xl p-4" id="wallet-keys-card">
          <div class="text-[0.6875rem] font-semibold uppercase tracking-wider text-txt-3 mb-2.5">Keys</div>
          <div id="wallet-keys-content">
            <div id="wallet-no-keys">
              <p class="wallet-hint">Generate or import keys to begin</p>
              <div class="flex gap-2 flex-wrap mt-3">
                <button type="button" class="btn-press inline-flex items-center gap-2 px-3.5 py-1.5 rounded-lg text-xs font-semibold text-white cursor-pointer transition-all" id="btn-generate-keys" style="background:linear-gradient(135deg,var(--accent),var(--accent2))">Generate Keys</button>
                <button type="button" class="btn-press inline-flex items-center gap-2 px-3.5 py-1.5 bg-transparent text-txt-2 border border-white/10 rounded-lg text-xs font-medium cursor-pointer transition-all hover:text-txt hover:bg-surface" id="btn-import-chipnet-json">Import JSON</button>
                <input type="file" id="import-chipnet-json-file" accept=".json" style="display:none">
              </div>
            </div>
            <div id="wallet-has-keys" style="display:none">
              <div class="flex flex-col gap-0.5 mb-2 p-2 bg-base-light border border-white/[0.06] rounded-md">
                <span class="text-[0.6875rem] text-txt-3 font-semibold uppercase tracking-wide">Owner</span>
                <span class="wallet-addr-value" id="wallet-owner-addr"></span>
              </div>
              <div class="flex flex-col gap-0.5 mb-2 p-2 bg-base-light border border-white/[0.06] rounded-md">
                <span class="text-[0.6875rem] text-txt-3 font-semibold uppercase tracking-wide">Recipient</span>
                <span class="wallet-addr-value" id="wallet-recipient-addr"></span>
              </div>
              <div class="flex flex-col gap-0.5 mb-2 p-2 bg-base-light border border-white/[0.06] rounded-md">
                <span class="text-[0.6875rem] text-txt-3 font-semibold uppercase tracking-wide">Oracle</span>
                <span class="wallet-addr-value" id="wallet-oracle-addr"></span>
              </div>
              <div class="flex gap-2 flex-wrap mt-2">
                <button type="button" class="btn-press inline-flex items-center gap-2 px-3.5 py-1.5 bg-transparent text-txt-2 border border-white/10 rounded-lg text-xs font-medium cursor-pointer transition-all hover:text-txt hover:bg-surface" id="btn-download-chipnet-keys">Download Keys</button>
                <button type="button" class="btn-press inline-flex items-center gap-2 px-3.5 py-1.5 bg-transparent text-err border border-err/30 rounded-lg text-xs font-medium cursor-pointer transition-all hover:bg-err/[0.08]" id="btn-delete-keys">Delete Keys</button>
              </div>
            </div>
          </div>
        </div>
        <!-- Balance Card -->
        <div class="bg-surface border border-white/[0.06] rounded-xl p-4" id="wallet-balance-card">
          <div class="text-[0.6875rem] font-semibold uppercase tracking-wider text-txt-3 mb-2.5">Balances</div>
          <div class="flex items-baseline justify-between gap-2 py-1.5 border-b border-white/[0.06]">
            <span class="text-[0.7rem] font-semibold uppercase tracking-wide text-txt-3">Owner</span>
            <span class="balance-gradient text-base font-extrabold font-mono tracking-tight text-right" id="wallet-balance-owner">&mdash;</span>
          </div>
          <div class="flex items-baseline justify-between gap-2 py-1.5 border-b border-white/[0.06]">
            <span class="text-[0.7rem] font-semibold uppercase tracking-wide text-txt-3">Recipient</span>
            <span class="balance-gradient text-base font-extrabold font-mono tracking-tight text-right" id="wallet-balance-recipient">&mdash;</span>
          </div>
          <div class="flex items-baseline justify-between gap-2 py-1.5">
            <span class="text-[0.7rem] font-semibold uppercase tracking-wide text-txt-3">Oracle</span>
            <span class="balance-gradient text-base font-extrabold font-mono tracking-tight text-right" id="wallet-balance-oracle">&mdash;</span>
          </div>
          <div class="text-xs text-txt-3 mt-1 font-mono" id="wallet-utxo-count"></div>
          <button type="button" class="btn-press inline-flex items-center gap-2 px-3.5 py-1.5 bg-transparent text-txt-2 border border-white/10 rounded-lg text-xs font-medium cursor-pointer transition-all hover:text-txt hover:bg-surface mt-2" id="btn-refresh-balance">Refresh All</button>
        </div>
        <!-- Fund Card -->
        <div class="bg-surface border border-white/[0.06] rounded-xl p-4" id="wallet-fund-card">
          <div class="text-[0.6875rem] font-semibold uppercase tracking-wider text-txt-3 mb-2.5">Fund via Faucet</div>
          <div id="wallet-qr" class="flex justify-center min-h-[60px] items-center"></div>
          <a href="https://tbch.googol.cash/" target="_blank" rel="noopener" class="btn-press inline-flex items-center justify-center gap-2 px-3.5 py-1.5 bg-transparent text-txt-2 border border-white/10 rounded-lg text-xs font-medium cursor-pointer transition-all hover:text-txt hover:bg-surface mt-2 no-underline w-full text-center">Open Faucet</a>
        </div>
      </div>
    </div>
  </div>

  <!-- ── Hero ── -->
  <section class="relative overflow-hidden border-b border-white/[0.06]" style="background:radial-gradient(ellipse 80% 60% at 50% 0%,rgba(79,143,255,0.08) 0%,transparent 70%),radial-gradient(ellipse 60% 50% at 80% 20%,rgba(124,58,237,0.06) 0%,transparent 60%),var(--bg)">
    <div class="max-w-container mx-auto px-5 md:px-8 pt-16 pb-12 grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
      <div>
        <div class="inline-block text-xs font-semibold uppercase tracking-widest text-accent bg-accent/10 border border-accent/15 px-3 py-1 rounded-full mb-5">Bitcoin Cash DeFi</div>
        <h1 class="hero-title-gradient text-4xl md:text-5xl font-extrabold tracking-tight leading-[1.15] mb-4">Composable UTXO<br>Building Blocks</h1>
        <p class="text-base text-txt-2 leading-7 max-w-[480px] mb-7">4 smart contract primitives composed atomically into production DeFi protocols. No backend. No admin keys. Pure on-chain enforcement.</p>
        <div class="flex flex-col sm:flex-row gap-3">
          <button type="button" class="btn-press inline-flex items-center justify-center gap-2 px-6 py-3 rounded-lg text-sm font-semibold text-white cursor-pointer transition-all hover:-translate-y-px" id="hero-run-btn" style="background:linear-gradient(135deg,var(--accent),var(--accent2));box-shadow:0 2px 12px rgba(79,143,255,0.3)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
            Run Scenarios
          </button>
          <button type="button" class="btn-press inline-flex items-center justify-center gap-2 px-6 py-3 bg-transparent text-txt-2 border border-white/10 rounded-lg text-sm font-medium cursor-pointer transition-all hover:text-txt hover:border-white/20 hover:bg-surface" id="hero-sdk-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
            View SDK Code
          </button>
        </div>
      </div>
      <div class="hero-stats grid grid-cols-2 gap-4">
        <div class="bg-surface border border-white/[0.06] rounded-xl p-5 transition-all hover:border-white/10 hover:bg-surface-2">
          <div class="stat-value-gradient text-3xl font-extrabold tracking-tight leading-none mb-1.5">4</div>
          <div class="text-sm font-semibold mb-0.5">Primitives</div>
          <div class="text-[0.6875rem] text-txt-3">Vault + Time + Oracle + Token</div>
        </div>
        <div class="bg-surface border border-white/[0.06] rounded-xl p-5 transition-all hover:border-white/10 hover:bg-surface-2">
          <div class="stat-value-gradient text-3xl font-extrabold tracking-tight leading-none mb-1.5" id="metricBlocked">0</div>
          <div class="text-sm font-semibold mb-0.5">Attacks Blocked</div>
          <div class="text-[0.6875rem] text-txt-3">On-chain enforcement</div>
        </div>
        <div class="bg-surface border border-white/[0.06] rounded-xl p-5 transition-all hover:border-white/10 hover:bg-surface-2">
          <div class="stat-value-gradient text-3xl font-extrabold tracking-tight leading-none mb-1.5" id="metricProcessed">0</div>
          <div class="text-sm font-semibold mb-0.5">TX Processed</div>
          <div class="text-[0.6875rem] text-txt-3">Atomic composition</div>
        </div>
        <div class="bg-surface border border-white/[0.06] rounded-xl p-5 transition-all hover:border-white/10 hover:bg-surface-2">
          <div class="stat-value-gradient text-3xl font-extrabold tracking-tight leading-none mb-1.5">4</div>
          <div class="text-sm font-semibold mb-0.5">DeFi Protocols</div>
          <div class="text-[0.6875rem] text-txt-3">Lend + DAO + Yield + Insurance</div>
        </div>
      </div>
    </div>
    <div class="absolute -top-1/2 left-1/2 -translate-x-1/2 w-[800px] h-[800px] pointer-events-none" style="background:radial-gradient(circle,rgba(79,143,255,0.06) 0%,transparent 60%)"></div>
  </section>

  <!-- ── Scenario Section ── -->
  <section class="bg-base-light min-h-[calc(100vh-60px)]" id="scenarios">
    <div class="max-w-container mx-auto p-5 md:p-8 grid grid-cols-1 lg:grid-cols-[240px_1fr] gap-6 min-h-[600px]">

      <!-- Sidebar -->
      <aside class="flex flex-row lg:flex-col gap-1 overflow-x-auto lg:overflow-visible lg:sticky lg:top-[84px] lg:self-start pb-2 lg:pb-0">
        <div class="hidden lg:block text-[0.6875rem] font-semibold uppercase tracking-wider text-txt-3 px-3 py-2">Protocols</div>
        <button class="sidebar-item active flex items-center gap-3 px-3 py-2.5 bg-transparent border border-transparent rounded-lg cursor-pointer transition-all text-left text-txt-2 w-auto lg:w-full whitespace-nowrap lg:whitespace-normal" data-scenario="lending">
          <div class="w-9 h-9 rounded-lg flex items-center justify-center shrink-0" style="background:var(--vault-bg);color:var(--vault)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
          </div>
          <div class="flex flex-row lg:flex-col gap-1 lg:gap-0 items-center lg:items-start">
            <span class="text-sm font-semibold leading-tight">Lending Pool</span>
            <span class="hidden lg:inline text-[0.6875rem] text-txt-3">4 primitives</span>
          </div>
        </button>
        <button class="sidebar-item flex items-center gap-3 px-3 py-2.5 bg-transparent border border-transparent rounded-lg cursor-pointer transition-all text-left text-txt-2 w-auto lg:w-full whitespace-nowrap lg:whitespace-normal" data-scenario="governance">
          <div class="w-9 h-9 rounded-lg flex items-center justify-center shrink-0" style="background:rgba(79,143,255,0.1);color:var(--accent)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
          </div>
          <div class="flex flex-row lg:flex-col gap-1 lg:gap-0 items-center lg:items-start">
            <span class="text-sm font-semibold leading-tight">DAO Governance</span>
            <span class="hidden lg:inline text-[0.6875rem] text-txt-3">4 primitives</span>
          </div>
        </button>
        <button class="sidebar-item flex items-center gap-3 px-3 py-2.5 bg-transparent border border-transparent rounded-lg cursor-pointer transition-all text-left text-txt-2 w-auto lg:w-full whitespace-nowrap lg:whitespace-normal" data-scenario="yield-vault">
          <div class="w-9 h-9 rounded-lg flex items-center justify-center shrink-0" style="background:var(--timestate-bg);color:var(--timestate)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
          </div>
          <div class="flex flex-row lg:flex-col gap-1 lg:gap-0 items-center lg:items-start">
            <span class="text-sm font-semibold leading-tight">Yield Vault</span>
            <span class="hidden lg:inline text-[0.6875rem] text-txt-3">3 primitives</span>
          </div>
        </button>
        <button class="sidebar-item flex items-center gap-3 px-3 py-2.5 bg-transparent border border-transparent rounded-lg cursor-pointer transition-all text-left text-txt-2 w-auto lg:w-full whitespace-nowrap lg:whitespace-normal" data-scenario="insurance">
          <div class="w-9 h-9 rounded-lg flex items-center justify-center shrink-0" style="background:var(--oracle-bg);color:var(--oracle)">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
          </div>
          <div class="flex flex-row lg:flex-col gap-1 lg:gap-0 items-center lg:items-start">
            <span class="text-sm font-semibold leading-tight">Insurance Pool</span>
            <span class="hidden lg:inline text-[0.6875rem] text-txt-3">4 primitives</span>
          </div>
        </button>
        <div class="hidden lg:block h-px bg-white/[0.06] mx-3 my-2"></div>
        <div class="w-px h-8 bg-white/[0.06] mx-1 lg:hidden"></div>
        <button class="sidebar-item flex items-center gap-3 px-3 py-2.5 bg-transparent border border-transparent rounded-lg cursor-pointer transition-all text-left text-txt-2 w-auto lg:w-full whitespace-nowrap lg:whitespace-normal" data-scenario="sdk">
          <div class="w-9 h-9 rounded-lg flex items-center justify-center shrink-0 bg-surface-2 text-txt-3">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
          </div>
          <div class="flex flex-row lg:flex-col gap-1 lg:gap-0 items-center lg:items-start">
            <span class="text-sm font-semibold leading-tight">SDK Code</span>
            <span class="hidden lg:inline text-[0.6875rem] text-txt-3">Examples</span>
          </div>
        </button>
      </aside>

      <!-- Content Area -->
      <div class="min-w-0">

        <!-- Lending Panel -->
        <div class="scenario-panel active" id="panel-lending">
          <div class="flex flex-col md:flex-row items-start justify-between gap-4 bg-surface border border-white/[0.06] rounded-xl p-6 mb-4">
            <div class="flex-1 min-w-0">
              <h2 class="text-2xl font-bold tracking-tight mb-1">Lending Pool</h2>
              <p class="text-sm text-txt-2 mb-3">Credit-scored micro-lending with 4-primitive atomic composition</p>
              <div class="flex gap-1.5 flex-wrap">
                <span class="prim-tag vault">Vault</span>
                <span class="prim-tag timestate">TimeState</span>
                <span class="prim-tag oracle">Oracle</span>
                <span class="prim-tag tokengate">TokenGate</span>
              </div>
            </div>
          </div>

          <!-- Lending Tabs -->
          <div class="flex items-center bg-surface/80 backdrop-blur-sm border border-white/[0.06] rounded-xl p-1 gap-0.5">
            <button class="lending-tab active relative flex items-center gap-2 px-4 py-2 rounded-lg bg-transparent border-none text-txt-3 text-sm cursor-pointer font-medium transition-all hover:text-txt-2 hover:bg-surface-2" data-ltab="dashboard">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="opacity-50"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
              Dashboard
            </button>
            <button class="lending-tab disabled relative flex items-center gap-2 px-4 py-2 rounded-lg bg-transparent border-none text-txt-3 text-sm cursor-pointer font-medium transition-all" data-ltab="borrow" id="ltab-borrow">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="opacity-50"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
              Borrow
            </button>
            <button class="lending-tab disabled relative flex items-center gap-2 px-4 py-2 rounded-lg bg-transparent border-none text-txt-3 text-sm cursor-pointer font-medium transition-all" data-ltab="history" id="ltab-history">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="opacity-50"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
              History
            </button>
            <button class="lending-tab relative flex items-center gap-2 px-4 py-2 rounded-lg bg-transparent border-none text-txt-3 text-sm cursor-pointer font-medium transition-all hover:text-txt-2 hover:bg-surface-2" data-ltab="demo">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="opacity-50"><polygon points="5 3 19 12 5 21 5 3"/></svg>
              Demo
            </button>
          </div>

          <!-- Tab: Dashboard -->
          <div class="lending-tab-content active" id="ltab-content-dashboard">
            <div class="glass-card" id="lending-init-card">
              <div id="lending-loading-overlay" class="loading-overlay" style="display:none">
                <div class="loading-ring"></div>
                <div class="text-base font-semibold">Initializing Pool</div>
                <div class="text-xs text-txt-3 -mt-2" id="loading-subtext">Deploying contracts on chipnet...</div>
              </div>
              <div id="lending-init-form">
                <!-- Header with icon -->
                <div class="flex items-center gap-3 mb-6">
                  <div class="w-11 h-11 rounded-xl flex items-center justify-center shrink-0" style="background:linear-gradient(135deg,rgba(79,143,255,0.15),rgba(124,58,237,0.15))">
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
                  </div>
                  <div>
                    <div class="text-lg font-bold tracking-tight">Initialize Lending Pool</div>
                    <div class="text-xs text-txt-3">Configure pool parameters and deploy on-chain</div>
                  </div>
                </div>
                <!-- Input cards -->
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                  <div class="bg-base-light/50 border border-white/[0.06] rounded-xl p-4 transition-all hover:border-white/10">
                    <div class="flex items-center gap-2 mb-3">
                      <div class="w-7 h-7 rounded-lg flex items-center justify-center" style="background:rgba(167,139,250,0.1)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--vault)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
                      </div>
                      <label class="text-xs font-semibold text-txt-2 uppercase tracking-wide" for="init-pool-balance">Pool Balance</label>
                    </div>
                    <div class="relative flex items-center">
                      <input type="number" id="init-pool-balance" class="w-full pr-14 text-xl h-12 rounded-lg bg-base border border-white/10 text-txt font-mono outline-none transition-all focus:border-accent focus:shadow-[0_0_0_3px_rgba(79,143,255,0.15)]" style="padding:0.55rem 3.5rem 0.55rem 0.75rem" value="5000000" min="10000">
                      <span class="absolute right-3 text-xs font-semibold text-txt-3 pointer-events-none font-mono">sats</span>
                    </div>
                    <div class="text-[0.65rem] text-txt-3 mt-2 leading-relaxed">Total liquidity deployed into the pool contract</div>
                  </div>
                  <div class="bg-base-light/50 border border-white/[0.06] rounded-xl p-4 transition-all hover:border-white/10">
                    <div class="flex items-center gap-2 mb-3">
                      <div class="w-7 h-7 rounded-lg flex items-center justify-center" style="background:rgba(79,143,255,0.1)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                      </div>
                      <label class="text-xs font-semibold text-txt-2 uppercase tracking-wide" for="init-max-loan">Max Loan</label>
                    </div>
                    <div class="relative flex items-center">
                      <input type="number" id="init-max-loan" class="w-full pr-14 text-xl h-12 rounded-lg bg-base border border-white/10 text-txt font-mono outline-none transition-all focus:border-accent focus:shadow-[0_0_0_3px_rgba(79,143,255,0.15)]" style="padding:0.55rem 3.5rem 0.55rem 0.75rem" value="500000" min="1000">
                      <span class="absolute right-3 text-xs font-semibold text-txt-3 pointer-events-none font-mono">sats</span>
                    </div>
                    <div class="text-[0.65rem] text-txt-3 mt-2 leading-relaxed">Maximum single loan enforced by Vault spend limit</div>
                  </div>
                  <div class="bg-base-light/50 border border-white/[0.06] rounded-xl p-4 transition-all hover:border-white/10">
                    <div class="flex items-center gap-2 mb-3">
                      <div class="w-7 h-7 rounded-lg flex items-center justify-center" style="background:rgba(248,113,113,0.1)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--oracle)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                      </div>
                      <label class="text-xs font-semibold text-txt-2 uppercase tracking-wide" for="init-min-score">Min Score</label>
                    </div>
                    <div class="relative flex items-center">
                      <input type="number" id="init-min-score" class="w-full pr-14 text-xl h-12 rounded-lg bg-base border border-white/10 text-txt font-mono outline-none transition-all focus:border-accent focus:shadow-[0_0_0_3px_rgba(79,143,255,0.15)]" style="padding:0.55rem 3.5rem 0.55rem 0.75rem" value="50" min="0" max="100">
                      <span class="absolute right-3 text-xs font-semibold text-txt-3 pointer-events-none font-mono">/100</span>
                    </div>
                    <div class="text-[0.65rem] text-txt-3 mt-2 leading-relaxed">Minimum credit score verified by Oracle proof</div>
                  </div>
                </div>
                <!-- Separator + info banner -->
                <div class="flex items-center gap-3 my-5">
                  <div class="flex-1 h-px bg-white/[0.06]"></div>
                  <span class="text-[0.6rem] text-txt-3 uppercase tracking-widest font-medium">4 Primitives</span>
                  <div class="flex-1 h-px bg-white/[0.06]"></div>
                </div>
                <div class="flex items-center gap-2.5 mb-4 px-3.5 py-2.5 rounded-lg text-xs text-txt-2" style="background:rgba(79,143,255,0.04);border:1px solid rgba(79,143,255,0.1)">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="shrink-0"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
                  <span>Deploys <strong class="text-vault">Vault</strong> + <strong class="text-timestate">TimeState</strong> + <strong class="text-oracle">Oracle</strong> + <strong class="text-tokengate">TokenGate</strong> contracts atomically</span>
                </div>
                <button type="button" class="btn-press w-full inline-flex items-center justify-center gap-2 px-6 py-3.5 rounded-xl text-sm font-semibold text-white cursor-pointer transition-all hover:-translate-y-px" id="btn-init-pool" style="background:linear-gradient(135deg,var(--accent),var(--accent2));box-shadow:0 2px 12px rgba(79,143,255,0.3)">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
                  Initialize Pool
                </button>
                <div class="mt-3 px-3 py-2 rounded-lg text-sm" id="init-error" style="display:none;background:var(--red-bg);border:1px solid rgba(255,92,92,0.3);color:var(--red)"></div>
              </div>
            </div>

            <!-- Pool Browser -->
            <div class="bg-surface border border-white/[0.06] rounded-xl overflow-hidden mt-4" id="lending-pool-browser">
              <div class="flex items-center justify-between px-5 py-3.5 border-b border-white/[0.06]" style="background:rgba(255,255,255,0.01)">
                <div class="flex items-center gap-2.5">
                  <div class="w-8 h-8 rounded-lg bg-accent/10 flex items-center justify-center text-accent">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
                  </div>
                  <div>
                    <div class="text-sm font-semibold text-txt">Available Pools</div>
                    <div class="text-[0.65rem] text-txt-3">Browse and join other lending pools</div>
                  </div>
                </div>
                <button type="button" class="btn-press inline-flex items-center gap-1.5 px-3 py-1.5 bg-surface-2 text-txt-2 border border-white/10 rounded-lg text-xs font-medium cursor-pointer transition-all hover:text-txt hover:bg-surface-3" id="btn-refresh-pools-dash">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/></svg>
                  Refresh
                </button>
              </div>
              <div class="p-3 flex flex-col gap-2.5 max-h-[300px] overflow-y-auto" id="pool-browser-list-dash">
                <div class="text-sm text-txt-3 py-8 px-4 text-center flex flex-col items-center gap-3" id="pool-browser-empty-dash">
                  <div class="w-12 h-12 rounded-full bg-surface-2 border border-white/[0.06] flex items-center justify-center text-txt-3">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 0 1-9 9m9-9a9 9 0 0 0-9-9m9 9H3m9 9a9 9 0 0 1-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9"/></svg>
                  </div>
                  <div>
                    <div class="text-sm font-medium text-txt-2">No Pools Available</div>
                    <div class="text-xs text-txt-3 mt-1">Be the first to create a lending pool above</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Active Pool Dashboard -->
            <div id="lending-dashboard" style="display:none">
              <!-- Stat cards with icons -->
              <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-5">
                <div class="bg-base-light border border-white/[0.06] rounded-xl p-5 transition-all hover:border-white/10 hover:-translate-y-1 hover:shadow-xl group">
                  <div class="flex items-center justify-between mb-3">
                    <div class="text-[0.6875rem] font-semibold uppercase tracking-wider text-txt-3">Pool Balance</div>
                    <div class="w-8 h-8 rounded-lg flex items-center justify-center opacity-60 group-hover:opacity-100 transition-opacity" style="background:rgba(167,139,250,0.1)">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--vault)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
                    </div>
                  </div>
                  <div class="balance-gradient text-2xl font-extrabold font-mono tracking-tight leading-tight" id="dash-pool-balance">0.00000000</div>
                  <div class="text-[0.6875rem] text-txt-3 mt-1">BCH</div>
                </div>
                <div class="bg-base-light border border-white/[0.06] rounded-xl p-5 transition-all hover:border-white/10 hover:-translate-y-1 hover:shadow-xl group">
                  <div class="flex items-center justify-between mb-3">
                    <div class="text-[0.6875rem] font-semibold uppercase tracking-wider text-txt-3">Remaining</div>
                    <div class="w-8 h-8 rounded-lg flex items-center justify-center opacity-60 group-hover:opacity-100 transition-opacity" style="background:rgba(79,143,255,0.1)">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                    </div>
                  </div>
                  <div class="balance-gradient text-2xl font-extrabold font-mono tracking-tight leading-tight" id="dash-remaining">0.00000000</div>
                  <div class="text-[0.6875rem] text-txt-3 mt-1">BCH</div>
                </div>
                <div class="bg-base-light border border-white/[0.06] rounded-xl p-5 transition-all hover:border-white/10 hover:-translate-y-1 hover:shadow-xl group">
                  <div class="flex items-center justify-between mb-3">
                    <div class="text-[0.6875rem] font-semibold uppercase tracking-wider text-txt-3">Loans Processed</div>
                    <div class="w-8 h-8 rounded-lg flex items-center justify-center opacity-60 group-hover:opacity-100 transition-opacity" style="background:rgba(34,211,238,0.1)">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--timestate)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
                    </div>
                  </div>
                  <div class="balance-gradient text-2xl font-extrabold font-mono tracking-tight leading-tight" id="dash-tx-count">0</div>
                  <div class="text-[0.6875rem] text-txt-3 mt-1">transactions</div>
                </div>
              </div>

              <!-- Ring Chart — enlarged -->
              <div class="bg-base-light border border-white/[0.06] rounded-xl p-6 mb-5">
                <div class="flex flex-col sm:flex-row items-center gap-8">
                  <div class="relative w-[140px] h-[140px] shrink-0">
                    <div class="absolute inset-0 rounded-full border-2 border-white/[0.03]"></div>
                    <svg viewBox="0 0 100 100" class="w-[140px] h-[140px]" style="transform:rotate(-90deg)">
                      <circle class="ring-bg" cx="50" cy="50" r="40"/>
                      <circle class="ring-fill" id="ring-fill" cx="50" cy="50" r="40" stroke-dasharray="251.33" stroke-dashoffset="251.33"/>
                    </svg>
                    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-center">
                      <div class="text-2xl font-extrabold font-mono leading-none" id="ring-pct">0%</div>
                      <div class="text-[0.65rem] text-txt-3 uppercase tracking-wide mt-1">Utilized</div>
                    </div>
                  </div>
                  <div class="flex-1 min-w-0 text-center sm:text-left">
                    <div class="text-xs font-semibold text-txt-2 uppercase tracking-wider mb-3">Pool Utilization</div>
                    <div id="health-badge" class="health-badge health-healthy">
                      <span class="w-2 h-2 rounded-full" style="background:currentColor;box-shadow:0 0 8px currentColor"></span>
                      <span id="health-text">Healthy</span>
                    </div>
                    <div class="grid grid-cols-2 gap-4 mt-4">
                      <div class="bg-surface/50 rounded-lg p-3 border border-white/[0.04]">
                        <span class="text-lg font-bold font-mono" id="ring-lent">0</span>
                        <div class="text-[0.65rem] text-txt-3 uppercase tracking-wide mt-0.5">Lent Out</div>
                      </div>
                      <div class="bg-surface/50 rounded-lg p-3 border border-white/[0.04]">
                        <span class="text-lg font-bold font-mono" id="ring-available">0</span>
                        <div class="text-[0.65rem] text-txt-3 uppercase tracking-wide mt-0.5">Available</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Parameter pills — card grid -->
              <div class="grid grid-cols-3 gap-3 mb-5">
                <div class="flex items-center gap-2 px-3.5 py-2.5 bg-surface border border-white/[0.06] rounded-xl transition-all hover:border-white/10">
                  <div class="w-6 h-6 rounded-md flex items-center justify-center shrink-0" style="background:rgba(79,143,255,0.1)">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                  </div>
                  <div class="min-w-0">
                    <div class="text-[0.6rem] text-txt-3 uppercase tracking-wide font-medium">Max Loan</div>
                    <div class="font-semibold font-mono text-[0.75rem] text-txt truncate" id="dash-max-loan">&mdash;</div>
                  </div>
                </div>
                <div class="flex items-center gap-2 px-3.5 py-2.5 bg-surface border border-white/[0.06] rounded-xl transition-all hover:border-white/10">
                  <div class="w-6 h-6 rounded-md flex items-center justify-center shrink-0" style="background:rgba(248,113,113,0.1)">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="var(--oracle)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                  </div>
                  <div class="min-w-0">
                    <div class="text-[0.6rem] text-txt-3 uppercase tracking-wide font-medium">Min Score</div>
                    <div class="font-semibold font-mono text-[0.75rem] text-txt truncate" id="dash-min-score">&mdash;</div>
                  </div>
                </div>
                <div class="flex items-center gap-2 px-3.5 py-2.5 bg-surface border border-white/[0.06] rounded-xl transition-all hover:border-white/10">
                  <div class="w-6 h-6 rounded-md flex items-center justify-center shrink-0" style="background:rgba(34,211,238,0.1)">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="var(--timestate)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                  </div>
                  <div class="min-w-0">
                    <div class="text-[0.6rem] text-txt-3 uppercase tracking-wide font-medium">Mode</div>
                    <div class="font-semibold font-mono text-[0.75rem] text-txt truncate" id="dash-mode">&mdash;</div>
                  </div>
                </div>
              </div>

              <!-- Recent Activity — card container -->
              <div id="recent-activity" style="display:none" class="mt-5 bg-base-light border border-white/[0.06] rounded-xl overflow-hidden">
                <div class="flex items-center gap-2 px-5 py-3 border-b border-white/[0.06]" style="background:rgba(255,255,255,0.01)">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="shrink-0"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
                  <span class="text-xs font-semibold uppercase tracking-wider text-txt-3">Recent Activity</span>
                </div>
                <div class="p-3 flex flex-col gap-1.5" id="recent-list"></div>
              </div>

              <button type="button" class="btn-press inline-flex items-center gap-2 px-3.5 py-1.5 bg-transparent text-err border border-err/30 rounded-lg text-xs font-medium cursor-pointer transition-all hover:bg-err/[0.08] mt-5" id="btn-destroy-pool">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
                Destroy Pool
              </button>
            </div>
          </div>

          <!-- Tab: Borrow -->
          <div class="lending-tab-content" id="ltab-content-borrow">
            <div id="borrow-no-session">
              <div class="flex flex-col items-center gap-4 py-14 px-6 text-center">
                <div class="w-20 h-20 rounded-2xl bg-surface-2 border border-white/[0.06] flex items-center justify-center text-txt-3 mb-2">
                  <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                </div>
                <div class="text-lg font-bold text-txt">No Active Pool</div>
                <div class="text-sm text-txt-3 max-w-[320px] leading-relaxed">Initialize or join a pool from the Dashboard tab to start requesting loans.</div>
                <div class="w-16 h-0.5 rounded-full bg-accent/20 mt-2"></div>
              </div>
            </div>
            <div class="glass-card max-w-[520px] mx-auto" id="borrow-swap-card" style="display:none">
              <!-- Card header -->
              <div class="flex items-center justify-between mb-5">
                <div class="flex items-center gap-2.5">
                  <div class="w-9 h-9 rounded-xl flex items-center justify-center" style="background:linear-gradient(135deg,rgba(79,143,255,0.15),rgba(124,58,237,0.15))">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                  </div>
                  <div class="text-base font-bold">Request Loan</div>
                </div>
                <div class="text-xs text-txt-3 font-mono px-2.5 py-1 bg-surface/50 rounded-lg border border-white/[0.04]" id="loan-max-hint">Max: &mdash;</div>
              </div>

              <div id="borrow-form">
                <!-- Recipient card -->
                <div class="bg-base-light/50 border border-white/[0.06] rounded-xl p-4 mb-3">
                  <div class="flex items-center justify-between mb-2">
                    <label class="text-[0.65rem] font-semibold text-txt-3 uppercase tracking-wider" for="loan-recipient">Recipient Address</label>
                    <button type="button" class="btn-press inline-flex items-center gap-1.5 px-2.5 py-1 bg-surface/50 text-txt-3 border border-white/[0.06] rounded-md text-[0.65rem] font-medium cursor-pointer transition-all hover:text-accent hover:border-accent/20 shrink-0" id="btn-use-my-address">
                      <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                      My Address
                    </button>
                  </div>
                  <input type="text" id="loan-recipient" class="w-full h-[42px] rounded-lg bg-base border border-white/[0.04] text-txt font-mono text-sm outline-none transition-all focus:border-accent focus:shadow-[0_0_0_3px_rgba(79,143,255,0.15)] px-3" placeholder="bchtest:qz..." spellcheck="false">
                  <div class="text-[0.65rem] text-txt-3 mt-1.5 font-mono" id="recipient-hint">Enter the BCH address to receive loan funds</div>
                  <div class="text-[0.65rem] text-err mt-1 min-h-[0.875rem]" id="recipient-error-msg"></div>
                </div>

                <!-- Amount card -->
                <div class="bg-base-light/50 border border-white/[0.06] rounded-xl p-4 mb-3">
                  <div class="flex items-center justify-between mb-2">
                    <label class="text-[0.65rem] font-semibold text-txt-3 uppercase tracking-wider" for="loan-amount">Loan Amount</label>
                    <div class="flex gap-1">
                      <button type="button" class="pct-btn btn-press px-2 py-0.5 bg-surface/50 border border-white/[0.06] rounded-md text-[0.65rem] font-semibold cursor-pointer transition-all text-txt-3 hover:text-accent hover:border-accent/30" data-pct="25">25%</button>
                      <button type="button" class="pct-btn btn-press px-2 py-0.5 bg-surface/50 border border-white/[0.06] rounded-md text-[0.65rem] font-semibold cursor-pointer transition-all text-txt-3 hover:text-accent hover:border-accent/30" data-pct="50">50%</button>
                      <button type="button" class="pct-btn btn-press px-2 py-0.5 bg-surface/50 border border-white/[0.06] rounded-md text-[0.65rem] font-semibold cursor-pointer transition-all text-txt-3 hover:text-accent hover:border-accent/30" data-pct="75">75%</button>
                      <button type="button" class="pct-btn btn-press px-2 py-0.5 bg-surface/50 border border-white/[0.06] rounded-md text-[0.65rem] font-semibold cursor-pointer transition-all text-txt-3 hover:text-accent hover:border-accent/30" data-pct="100">Max</button>
                    </div>
                  </div>
                  <div class="relative flex items-center">
                    <input type="number" id="loan-amount" class="w-full pr-[5.5rem] text-2xl h-14 rounded-lg bg-base border border-white/[0.04] text-txt font-mono outline-none transition-all focus:border-accent focus:shadow-[0_0_0_3px_rgba(79,143,255,0.15)]" style="padding:0.55rem 5.5rem 0.55rem 0.75rem" value="100000" min="546">
                    <button type="button" class="absolute right-14 px-2 py-0.5 rounded text-[0.6rem] font-bold uppercase tracking-wide cursor-pointer transition-all" id="btn-max-loan" style="background:rgba(79,143,255,0.12);border:1px solid rgba(79,143,255,0.25);color:var(--accent)">MAX</button>
                    <span class="absolute right-3 text-xs font-semibold text-txt-3 pointer-events-none font-mono">sats</span>
                  </div>
                  <div class="text-[0.65rem] text-err mt-1 min-h-[0.875rem]" id="loan-error-msg"></div>
                </div>

                <!-- Credit Score card -->
                <div class="bg-base-light/50 border border-white/[0.06] rounded-xl p-4 mb-4">
                  <div class="flex items-center justify-between mb-3">
                    <label class="text-[0.65rem] font-semibold text-txt-3 uppercase tracking-wider">Credit Score</label>
                    <span id="score-display" class="text-xl font-extrabold font-mono text-warn transition-colors">50</span>
                  </div>
                  <!-- Zone labels -->
                  <div class="flex justify-between mb-2 px-0.5">
                    <span class="text-[0.55rem] font-semibold text-err uppercase tracking-wider">Poor</span>
                    <span class="text-[0.55rem] font-semibold text-warn uppercase tracking-wider">Fair</span>
                    <span class="text-[0.55rem] font-semibold text-ok uppercase tracking-wider">Good</span>
                    <span class="text-[0.55rem] font-semibold text-ok uppercase tracking-wider">Excellent</span>
                  </div>
                  <div class="relative py-2">
                    <div class="score-tooltip score-med" id="score-tooltip"><span>50</span></div>
                    <input type="range" id="credit-score" class="score-slider" min="0" max="100" value="50">
                    <div class="score-threshold" id="score-threshold-marker"></div>
                  </div>
                  <!-- Tick marks -->
                  <div class="flex justify-between px-0.5 mt-1">
                    <span class="text-[0.6rem] text-txt-3">0</span>
                    <span class="text-[0.6rem] text-txt-3">25</span>
                    <span class="text-[0.6rem] text-warn font-semibold" id="score-min-label">Min: 50</span>
                    <span class="text-[0.6rem] text-txt-3">75</span>
                    <span class="text-[0.6rem] text-txt-3">100</span>
                  </div>
                </div>

                <!-- Submit button -->
                <button type="button" class="btn-press w-full inline-flex items-center justify-center gap-2 px-6 py-3.5 rounded-xl text-sm font-semibold text-white cursor-pointer transition-all hover:-translate-y-px" id="btn-request-loan" style="background:linear-gradient(135deg,var(--accent),var(--accent2));box-shadow:0 2px 12px rgba(79,143,255,0.3)">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                  Request Loan
                </button>

                <!-- Loan result -->
                <div class="loan-result" id="loan-result" style="display:none"></div>

                <!-- Loan attempts -->
                <div class="mt-6" id="loan-attempts">
                  <div class="flex items-center gap-2 mb-2.5">
                    <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="var(--text3)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="shrink-0"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                    <span class="text-xs font-semibold uppercase tracking-wider text-txt-3">Recent Attempts</span>
                  </div>
                  <div class="flex flex-col gap-1.5" id="loan-attempts-list"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Tab: History -->
          <div class="lending-tab-content" id="ltab-content-history">
            <div id="history-no-session">
              <div class="flex flex-col items-center gap-4 py-14 px-6 text-center">
                <div class="w-20 h-20 rounded-2xl bg-surface-2 border border-white/[0.06] flex items-center justify-center text-txt-3 mb-2">
                  <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                </div>
                <div class="text-lg font-bold text-txt">No Transaction History</div>
                <div class="text-sm text-txt-3 max-w-[320px] leading-relaxed">Initialize a pool from the Dashboard tab to see transaction history.</div>
                <div class="w-16 h-0.5 rounded-full bg-accent/20 mt-2"></div>
              </div>
            </div>
            <div id="history-panel" style="display:none">
              <div class="bg-base-light border border-white/[0.06] rounded-xl overflow-hidden">
                <div class="overflow-x-auto">
                  <table class="w-full text-sm" style="border-collapse:collapse">
                    <thead class="sticky top-0 z-10">
                      <tr>
                        <th class="text-left px-4 py-3 text-[0.6875rem] font-semibold uppercase tracking-wide text-txt-3 border-b border-white/[0.06] bg-surface-2">#</th>
                        <th class="text-left px-4 py-3 text-[0.6875rem] font-semibold uppercase tracking-wide text-txt-3 border-b border-white/[0.06] bg-surface-2">Amount</th>
                        <th class="text-left px-4 py-3 text-[0.6875rem] font-semibold uppercase tracking-wide text-txt-3 border-b border-white/[0.06] bg-surface-2">Score</th>
                        <th class="text-left px-4 py-3 text-[0.6875rem] font-semibold uppercase tracking-wide text-txt-3 border-b border-white/[0.06] bg-surface-2">Status</th>
                        <th class="text-left px-4 py-3 text-[0.6875rem] font-semibold uppercase tracking-wide text-txt-3 border-b border-white/[0.06] bg-surface-2">TxID</th>
                        <th class="text-left px-4 py-3 text-[0.6875rem] font-semibold uppercase tracking-wide text-txt-3 border-b border-white/[0.06] bg-surface-2">Time</th>
                      </tr>
                    </thead>
                    <tbody id="history-tbody"></tbody>
                  </table>
                </div>
              </div>
              <div class="text-center py-10 text-txt-3" id="history-empty">
                <div class="flex flex-col items-center gap-2">
                  <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-txt-3 opacity-50"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
                  <div class="text-sm font-medium">No transactions yet</div>
                  <div class="text-xs text-txt-3">Loan requests will appear here</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Tab: Demo -->
          <div class="lending-tab-content" id="ltab-content-demo">
            <!-- Demo header card -->
            <div class="bg-base-light border border-white/[0.06] rounded-xl p-5 mb-4">
              <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
                <div class="flex items-center gap-3">
                  <div class="w-10 h-10 rounded-xl flex items-center justify-center shrink-0" style="background:linear-gradient(135deg,rgba(79,143,255,0.15),rgba(124,58,237,0.15))">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
                  </div>
                  <div>
                    <div class="text-sm font-semibold text-txt">Automated Demo</div>
                    <div class="text-xs text-txt-3">Run pre-scripted blocked/success transactions to see all 4 primitives in action</div>
                  </div>
                </div>
                <button class="btn-press inline-flex items-center gap-2 px-6 py-2.5 rounded-xl text-sm font-semibold text-white cursor-pointer transition-all hover:-translate-y-px shrink-0 disabled:opacity-50 disabled:cursor-not-allowed disabled:translate-y-0" type="button" data-run="lending" style="background:linear-gradient(135deg,var(--accent),var(--accent2));box-shadow:0 2px 12px rgba(79,143,255,0.3)">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
                  Run Scenario
                </button>
              </div>
            </div>
            <!-- Parameter pills — grid -->
            <div class="grid grid-cols-2 sm:grid-cols-4 gap-2 mb-4">
              <div class="flex items-center gap-2 px-3 py-2 bg-surface border border-white/[0.06] rounded-lg text-xs">
                <div class="w-5 h-5 rounded flex items-center justify-center shrink-0" style="background:rgba(167,139,250,0.1)">
                  <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="var(--vault)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
                </div>
                <div><span class="text-[0.6rem] text-txt-3 block">Pool</span><span class="font-semibold font-mono text-[0.7rem]">0.05 BCH</span></div>
              </div>
              <div class="flex items-center gap-2 px-3 py-2 bg-surface border border-white/[0.06] rounded-lg text-xs">
                <div class="w-5 h-5 rounded flex items-center justify-center shrink-0" style="background:rgba(79,143,255,0.1)">
                  <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                </div>
                <div><span class="text-[0.6rem] text-txt-3 block">Max Loan</span><span class="font-semibold font-mono text-[0.7rem]">500K sats</span></div>
              </div>
              <div class="flex items-center gap-2 px-3 py-2 bg-surface border border-white/[0.06] rounded-lg text-xs">
                <div class="w-5 h-5 rounded flex items-center justify-center shrink-0" style="background:rgba(248,113,113,0.1)">
                  <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="var(--oracle)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                </div>
                <div><span class="text-[0.6rem] text-txt-3 block">Min Score</span><span class="font-semibold font-mono text-[0.7rem]">50</span></div>
              </div>
              <div class="flex items-center gap-2 px-3 py-2 bg-surface border border-white/[0.06] rounded-lg text-xs">
                <div class="w-5 h-5 rounded flex items-center justify-center shrink-0" style="background:rgba(251,191,36,0.1)">
                  <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="var(--tokengate)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/></svg>
                </div>
                <div><span class="text-[0.6rem] text-txt-3 block">Gov Tokens</span><span class="font-semibold font-mono text-[0.7rem]">100</span></div>
              </div>
            </div>
            <!-- Timeline -->
            <div class="bg-surface border border-white/[0.06] rounded-xl overflow-hidden" id="timeline-lending" style="display:none">
              <div class="flex items-center justify-between px-5 py-3.5 border-b border-white/[0.06]" style="background:rgba(255,255,255,0.01)">
                <div class="flex items-center gap-2">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="shrink-0"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
                  <span class="text-xs font-semibold text-txt-2 uppercase tracking-wide">Execution Timeline</span>
                </div>
                <span class="text-xs text-txt-3 font-mono px-2 py-0.5 bg-surface-2 rounded-md" id="count-lending"></span>
              </div>
              <div class="p-3 flex flex-col gap-2 max-h-[520px] overflow-y-auto" id="steps-lending"></div>
              <div class="p-5 border-t border-white/[0.06]" id="summary-lending" style="display:none;background:rgba(255,255,255,0.01)"></div>
            </div>
          </div>
        </div>

        <!-- Governance Panel -->
        <div class="scenario-panel" id="panel-governance">
          <div class="flex flex-col md:flex-row items-start justify-between gap-4 bg-surface border border-white/[0.06] rounded-xl p-6 mb-4">
            <div class="flex-1 min-w-0">
              <h2 class="text-2xl font-bold tracking-tight mb-1">DAO Governance</h2>
              <p class="text-sm text-txt-2 mb-3">Token-gated treasury proposals with vote verification</p>
              <div class="flex gap-1.5 flex-wrap">
                <span class="prim-tag vault">Vault</span>
                <span class="prim-tag timestate">TimeState</span>
                <span class="prim-tag oracle">Oracle</span>
                <span class="prim-tag tokengate">TokenGate</span>
              </div>
            </div>
            <button class="btn-press inline-flex items-center gap-2 px-6 py-2.5 rounded-lg text-sm font-semibold text-white cursor-pointer transition-all hover:-translate-y-px shrink-0 self-stretch md:self-auto justify-center disabled:opacity-50 disabled:cursor-not-allowed disabled:translate-y-0" type="button" data-run="governance" style="background:linear-gradient(135deg,var(--accent),var(--accent2));box-shadow:0 2px 8px rgba(79,143,255,0.25)">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
              Run Scenario
            </button>
          </div>
          <div class="flex gap-2 flex-wrap mb-4">
            <div class="flex items-center gap-1.5 px-3 py-1.5 bg-surface border border-white/[0.06] rounded-full text-xs"><span class="text-txt-3 font-medium">Treasury</span><span class="font-semibold font-mono text-[0.7rem]">0.10000000 BCH</span></div>
            <div class="flex items-center gap-1.5 px-3 py-1.5 bg-surface border border-white/[0.06] rounded-full text-xs"><span class="text-txt-3 font-medium">Max Proposal</span><span class="font-semibold font-mono text-[0.7rem]">0.02000000 BCH</span></div>
            <div class="flex items-center gap-1.5 px-3 py-1.5 bg-surface border border-white/[0.06] rounded-full text-xs"><span class="text-txt-3 font-medium">Min Votes</span><span class="font-semibold font-mono text-[0.7rem]">100</span></div>
            <div class="flex items-center gap-1.5 px-3 py-1.5 bg-surface border border-white/[0.06] rounded-full text-xs"><span class="text-txt-3 font-medium">Gov Tokens</span><span class="font-semibold font-mono text-[0.7rem]">50</span></div>
          </div>
          <div class="bg-surface border border-white/[0.06] rounded-xl overflow-hidden" id="timeline-governance" style="display:none">
            <div class="flex items-center justify-between px-5 py-3 border-b border-white/[0.06]" style="background:rgba(255,255,255,0.01)">
              <span class="text-xs font-semibold text-txt-2 uppercase tracking-wide">Execution Timeline</span>
              <span class="text-xs text-txt-3 font-mono" id="count-governance"></span>
            </div>
            <div class="p-3 flex flex-col gap-2 max-h-[520px] overflow-y-auto" id="steps-governance"></div>
            <div class="p-5 border-t border-white/[0.06]" id="summary-governance" style="display:none;background:rgba(255,255,255,0.01)"></div>
          </div>
        </div>

        <!-- Yield Vault Panel -->
        <div class="scenario-panel" id="panel-yield-vault">
          <div class="flex flex-col md:flex-row items-start justify-between gap-4 bg-surface border border-white/[0.06] rounded-xl p-6 mb-4">
            <div class="flex-1 min-w-0">
              <h2 class="text-2xl font-bold tracking-tight mb-1">Yield Vault</h2>
              <p class="text-sm text-txt-2 mb-3">Time-locked deposits with maturity-gated withdrawals</p>
              <div class="flex gap-1.5 flex-wrap">
                <span class="prim-tag vault">Vault</span>
                <span class="prim-tag timestate">TimeState</span>
                <span class="prim-tag tokengate">TokenGate</span>
              </div>
            </div>
            <button class="btn-press inline-flex items-center gap-2 px-6 py-2.5 rounded-lg text-sm font-semibold text-white cursor-pointer transition-all hover:-translate-y-px shrink-0 self-stretch md:self-auto justify-center disabled:opacity-50 disabled:cursor-not-allowed disabled:translate-y-0" type="button" data-run="yield-vault" style="background:linear-gradient(135deg,var(--accent),var(--accent2));box-shadow:0 2px 8px rgba(79,143,255,0.25)">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
              Run Scenario
            </button>
          </div>
          <div class="flex gap-2 flex-wrap mb-4">
            <div class="flex items-center gap-1.5 px-3 py-1.5 bg-surface border border-white/[0.06] rounded-full text-xs"><span class="text-txt-3 font-medium">Deposit</span><span class="font-semibold font-mono text-[0.7rem]">0.03000000 BCH</span></div>
            <div class="flex items-center gap-1.5 px-3 py-1.5 bg-surface border border-white/[0.06] rounded-full text-xs"><span class="text-txt-3 font-medium">Max Withdraw</span><span class="font-semibold font-mono text-[0.7rem]">0.01000000 BCH</span></div>
            <div class="flex items-center gap-1.5 px-3 py-1.5 bg-surface border border-white/[0.06] rounded-full text-xs"><span class="text-txt-3 font-medium">Stake Tokens</span><span class="font-semibold font-mono text-[0.7rem]">25</span></div>
          </div>
          <div class="bg-surface border border-white/[0.06] rounded-xl overflow-hidden" id="timeline-yield-vault" style="display:none">
            <div class="flex items-center justify-between px-5 py-3 border-b border-white/[0.06]" style="background:rgba(255,255,255,0.01)">
              <span class="text-xs font-semibold text-txt-2 uppercase tracking-wide">Execution Timeline</span>
              <span class="text-xs text-txt-3 font-mono" id="count-yield-vault"></span>
            </div>
            <div class="p-3 flex flex-col gap-2 max-h-[520px] overflow-y-auto" id="steps-yield-vault"></div>
            <div class="p-5 border-t border-white/[0.06]" id="summary-yield-vault" style="display:none;background:rgba(255,255,255,0.01)"></div>
          </div>
        </div>

        <!-- Insurance Panel -->
        <div class="scenario-panel" id="panel-insurance">
          <div class="flex flex-col md:flex-row items-start justify-between gap-4 bg-surface border border-white/[0.06] rounded-xl p-6 mb-4">
            <div class="flex-1 min-w-0">
              <h2 class="text-2xl font-bold tracking-tight mb-1">Insurance Pool</h2>
              <p class="text-sm text-txt-2 mb-3">Oracle-verified claim processing with coverage limits</p>
              <div class="flex gap-1.5 flex-wrap">
                <span class="prim-tag vault">Vault</span>
                <span class="prim-tag timestate">TimeState</span>
                <span class="prim-tag oracle">Oracle</span>
                <span class="prim-tag tokengate">TokenGate</span>
              </div>
            </div>
            <button class="btn-press inline-flex items-center gap-2 px-6 py-2.5 rounded-lg text-sm font-semibold text-white cursor-pointer transition-all hover:-translate-y-px shrink-0 self-stretch md:self-auto justify-center disabled:opacity-50 disabled:cursor-not-allowed disabled:translate-y-0" type="button" data-run="insurance" style="background:linear-gradient(135deg,var(--accent),var(--accent2));box-shadow:0 2px 8px rgba(79,143,255,0.25)">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
              Run Scenario
            </button>
          </div>
          <div class="flex gap-2 flex-wrap mb-4">
            <div class="flex items-center gap-1.5 px-3 py-1.5 bg-surface border border-white/[0.06] rounded-full text-xs"><span class="text-txt-3 font-medium">Pool</span><span class="font-semibold font-mono text-[0.7rem]">0.08000000 BCH</span></div>
            <div class="flex items-center gap-1.5 px-3 py-1.5 bg-surface border border-white/[0.06] rounded-full text-xs"><span class="text-txt-3 font-medium">Max Claim</span><span class="font-semibold font-mono text-[0.7rem]">0.01500000 BCH</span></div>
            <div class="flex items-center gap-1.5 px-3 py-1.5 bg-surface border border-white/[0.06] rounded-full text-xs"><span class="text-txt-3 font-medium">Min Damage</span><span class="font-semibold font-mono text-[0.7rem]">200</span></div>
            <div class="flex items-center gap-1.5 px-3 py-1.5 bg-surface border border-white/[0.06] rounded-full text-xs"><span class="text-txt-3 font-medium">Policy Tokens</span><span class="font-semibold font-mono text-[0.7rem]">10</span></div>
          </div>
          <div class="bg-surface border border-white/[0.06] rounded-xl overflow-hidden" id="timeline-insurance" style="display:none">
            <div class="flex items-center justify-between px-5 py-3 border-b border-white/[0.06]" style="background:rgba(255,255,255,0.01)">
              <span class="text-xs font-semibold text-txt-2 uppercase tracking-wide">Execution Timeline</span>
              <span class="text-xs text-txt-3 font-mono" id="count-insurance"></span>
            </div>
            <div class="p-3 flex flex-col gap-2 max-h-[520px] overflow-y-auto" id="steps-insurance"></div>
            <div class="p-5 border-t border-white/[0.06]" id="summary-insurance" style="display:none;background:rgba(255,255,255,0.01)"></div>
          </div>
        </div>

        <!-- SDK Code Panel -->
        <div class="scenario-panel" id="panel-sdk">
          <div class="bg-surface border border-white/[0.06] rounded-xl p-6 mb-4">
            <h2 class="text-2xl font-bold tracking-tight mb-1">SDK Code Examples</h2>
            <p class="text-sm text-txt-2">Build your own DeFi protocol with CashBlocks</p>
          </div>
          <div class="flex bg-surface border border-white/[0.06] border-b-0 rounded-t-xl overflow-hidden">
            <button class="code-tab active px-5 py-2.5 bg-transparent border-none border-r border-white/[0.06] text-txt-3 text-sm cursor-pointer font-medium transition-all hover:text-txt-2 hover:bg-surface-2" data-code="init">Initialize</button>
            <button class="code-tab px-5 py-2.5 bg-transparent border-none border-r border-white/[0.06] text-txt-3 text-sm cursor-pointer font-medium transition-all hover:text-txt-2 hover:bg-surface-2" data-code="oracle">Oracle Sign</button>
            <button class="code-tab px-5 py-2.5 bg-transparent border-none border-r border-white/[0.06] text-txt-3 text-sm cursor-pointer font-medium transition-all hover:text-txt-2 hover:bg-surface-2" data-code="compose">Compose TX</button>
            <button class="code-tab px-5 py-2.5 bg-transparent border-none text-txt-3 text-sm cursor-pointer font-medium transition-all hover:text-txt-2 hover:bg-surface-2" data-code="tokens">CashTokens</button>
          </div>
          <div class="bg-surface border border-white/[0.06] rounded-b-xl overflow-hidden" id="code-content"></div>
        </div>

      </div>
    </div>
  </section>

  <!-- ── Primitives Reference ── -->
  <section class="border-t border-white/[0.06] py-20" id="primitives" style="background:radial-gradient(ellipse 70% 50% at 50% 100%,rgba(79,143,255,0.04) 0%,transparent 60%),var(--bg)">
    <div class="max-w-container mx-auto px-5 md:px-8">
      <div class="text-center mb-12">
        <div class="text-xs font-semibold uppercase tracking-widest text-accent mb-3">Architecture</div>
        <h2 class="text-3xl font-extrabold tracking-tight mb-3">Composable Primitives</h2>
        <p class="text-base text-txt-2 max-w-[540px] mx-auto">Each primitive enforces a single security property. Compose them atomically for complex DeFi logic.</p>
      </div>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5">
        <div class="prim-card-line line-vault relative overflow-hidden bg-surface border border-white/[0.06] rounded-xl p-7 transition-all hover:border-white/10 hover:-translate-y-1 hover:shadow-xl">
          <div class="w-12 h-12 rounded-xl flex items-center justify-center mb-4" style="background:var(--vault-bg);color:var(--vault)">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
          </div>
          <h3 class="text-base font-bold mb-2">Vault</h3>
          <p class="text-sm text-txt-2 leading-relaxed mb-4">UTXO custody with per-transaction spending limits, whitelisted destinations, and covenant continuation</p>
          <div class="flex gap-1.5 flex-wrap">
            <span class="px-2 py-0.5 bg-surface-2 rounded text-[0.6875rem] text-txt-3 font-medium">Spend Limits</span>
            <span class="px-2 py-0.5 bg-surface-2 rounded text-[0.6875rem] text-txt-3 font-medium">Whitelist</span>
            <span class="px-2 py-0.5 bg-surface-2 rounded text-[0.6875rem] text-txt-3 font-medium">Covenant</span>
          </div>
        </div>
        <div class="prim-card-line line-timestate relative overflow-hidden bg-surface border border-white/[0.06] rounded-xl p-7 transition-all hover:border-white/10 hover:-translate-y-1 hover:shadow-xl">
          <div class="w-12 h-12 rounded-xl flex items-center justify-center mb-4" style="background:var(--timestate-bg);color:var(--timestate)">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
          </div>
          <h3 class="text-base font-bold mb-2">TimeState</h3>
          <p class="text-sm text-txt-2 leading-relaxed mb-4">Phase-based time gates enforced via CLTV: Locked, Restricted, and Unrestricted phases</p>
          <div class="flex gap-1.5 flex-wrap">
            <span class="px-2 py-0.5 bg-surface-2 rounded text-[0.6875rem] text-txt-3 font-medium">3 Phases</span>
            <span class="px-2 py-0.5 bg-surface-2 rounded text-[0.6875rem] text-txt-3 font-medium">CLTV</span>
            <span class="px-2 py-0.5 bg-surface-2 rounded text-[0.6875rem] text-txt-3 font-medium">Timelocks</span>
          </div>
        </div>
        <div class="prim-card-line line-oracle relative overflow-hidden bg-surface border border-white/[0.06] rounded-xl p-7 transition-all hover:border-white/10 hover:-translate-y-1 hover:shadow-xl">
          <div class="w-12 h-12 rounded-xl flex items-center justify-center mb-4" style="background:var(--oracle-bg);color:var(--oracle)">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
          </div>
          <h3 class="text-base font-bold mb-2">Oracle Proof</h3>
          <p class="text-sm text-txt-2 leading-relaxed mb-4">Off-chain data verified on-chain via Schnorr checkDataSig with domain separation and expiry</p>
          <div class="flex gap-1.5 flex-wrap">
            <span class="px-2 py-0.5 bg-surface-2 rounded text-[0.6875rem] text-txt-3 font-medium">Schnorr</span>
            <span class="px-2 py-0.5 bg-surface-2 rounded text-[0.6875rem] text-txt-3 font-medium">Domain Sep</span>
            <span class="px-2 py-0.5 bg-surface-2 rounded text-[0.6875rem] text-txt-3 font-medium">Expiry</span>
          </div>
        </div>
        <div class="prim-card-line line-tokengate relative overflow-hidden bg-surface border border-white/[0.06] rounded-xl p-7 transition-all hover:border-white/10 hover:-translate-y-1 hover:shadow-xl">
          <div class="w-12 h-12 rounded-xl flex items-center justify-center mb-4" style="background:var(--tokengate-bg);color:var(--tokengate)">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
          </div>
          <h3 class="text-base font-bold mb-2">TokenGate</h3>
          <p class="text-sm text-txt-2 leading-relaxed mb-4">CashToken ownership validation with fungible token gating and introspection opcodes</p>
          <div class="flex gap-1.5 flex-wrap">
            <span class="px-2 py-0.5 bg-surface-2 rounded text-[0.6875rem] text-txt-3 font-medium">CashTokens</span>
            <span class="px-2 py-0.5 bg-surface-2 rounded text-[0.6875rem] text-txt-3 font-medium">Fungible</span>
            <span class="px-2 py-0.5 bg-surface-2 rounded text-[0.6875rem] text-txt-3 font-medium">Introspect</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ── Footer ── -->
  <footer class="border-t border-white/[0.06] bg-base py-8">
    <div class="max-w-container mx-auto px-5 md:px-8 flex flex-col md:flex-row items-center justify-between gap-3 text-center md:text-left">
      <div class="flex items-center gap-2.5 text-sm text-txt-2">
        <div class="w-7 h-7 rounded-[7px] flex items-center justify-center shrink-0" style="background:linear-gradient(135deg,var(--accent),#7c3aed)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><rect x="2" y="6" width="8" height="12" rx="2" fill="#fff" opacity="0.9"/><rect x="14" y="6" width="8" height="12" rx="2" fill="#fff" opacity="0.5"/><rect x="8" y="3" width="8" height="18" rx="2" fill="#fff" opacity="0.7"/></svg>
        </div>
        <span>Built with <strong class="text-txt">CashBlocks SDK</strong></span>
      </div>
      <div class="flex items-center gap-4 text-xs text-txt-3">
        <span>CashScript ^0.11.0</span>
        <span class="w-px h-3 bg-white/10"></span>
        <span>Bitcoin Cash</span>
        <span class="w-px h-3 bg-white/10"></span>
        <span>MIT License</span>
      </div>
    </div>
  </footer>

  <!-- Toast Container -->
  <div class="fixed top-[72px] right-4 z-[9999] flex flex-col gap-2 pointer-events-none max-w-[380px]" id="toast-container"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>
  <script src="app.js"></script>
  <script>
  (function() {
    // ─── Wallet Dropdown Toggle ───
    var trigger = document.getElementById('wallet-trigger');
    var dropdown = document.getElementById('wallet-section');
    if (trigger && dropdown) {
      trigger.addEventListener('click', function(e) {
        e.stopPropagation();
        dropdown.classList.toggle('wallet-open');
        var chev = trigger.querySelector('.wallet-chevron');
        if (chev) chev.style.transform = dropdown.classList.contains('wallet-open') ? 'rotate(180deg)' : '';
      });
      document.addEventListener('click', function(e) {
        if (!dropdown.contains(e.target) && !trigger.contains(e.target)) {
          dropdown.classList.remove('wallet-open');
          var chev = trigger.querySelector('.wallet-chevron');
          if (chev) chev.style.transform = '';
        }
      });
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          dropdown.classList.remove('wallet-open');
          var chev = trigger.querySelector('.wallet-chevron');
          if (chev) chev.style.transform = '';
        }
      });
    }

    // ─── Wallet Auto-Init on Page Load ───
    var stored = localStorage.getItem('cashblocks_chipnet_keys');
    if (stored) {
      try {
        var keys = JSON.parse(stored);
        var noKeys = document.getElementById('wallet-no-keys');
        var hasKeys = document.getElementById('wallet-has-keys');
        if (noKeys) noKeys.style.display = 'none';
        if (hasKeys) hasKeys.style.display = '';
        var ownerEl = document.getElementById('wallet-owner-addr');
        var recipientEl = document.getElementById('wallet-recipient-addr');
        var oracleEl = document.getElementById('wallet-oracle-addr');
        if (ownerEl) ownerEl.textContent = keys.owner ? keys.owner.address : '';
        if (recipientEl) recipientEl.textContent = keys.recipient ? keys.recipient.address : '';
        if (oracleEl) oracleEl.textContent = keys.oracle ? keys.oracle.address : '';
        updateWalletTrigger(keys);
        setTimeout(function() {
          var btn = document.getElementById('btn-refresh-balance');
          if (btn) btn.click();
        }, 800);
      } catch (e) {}
    }

    // ─── Update Header Trigger ───
    function updateWalletTrigger(keys) {
      var label = document.getElementById('wallet-trigger-label');
      var bal = document.getElementById('wallet-trigger-balance');
      var trig = document.getElementById('wallet-trigger');
      if (keys && keys.owner && keys.owner.address) {
        var addr = keys.owner.address;
        if (label) label.textContent = addr.slice(0, 14) + '...' + addr.slice(-4);
        if (trig) trig.classList.add('wallet-active');
      } else {
        if (label) label.textContent = 'Wallet';
        if (bal) { bal.textContent = ''; bal.classList.add('hidden'); }
        if (trig) trig.classList.remove('wallet-active');
      }
    }

    // ─── Observe balance changes → update header trigger ───
    var balOwner = document.getElementById('wallet-balance-owner');
    if (balOwner) {
      new MutationObserver(function() {
        var text = balOwner.textContent;
        var bal = document.getElementById('wallet-trigger-balance');
        if (bal && text && text !== '\u2014') {
          bal.textContent = text;
          bal.classList.remove('hidden');
        } else if (bal) {
          bal.classList.add('hidden');
        }
      }).observe(balOwner, { childList: true, characterData: true, subtree: true });
    }

    // ─── Observe key generation/deletion → update header trigger ───
    var hasKeysEl = document.getElementById('wallet-has-keys');
    if (hasKeysEl) {
      new MutationObserver(function() {
        var s = localStorage.getItem('cashblocks_chipnet_keys');
        if (s) {
          try { updateWalletTrigger(JSON.parse(s)); } catch(e) {}
        } else {
          updateWalletTrigger(null);
        }
      }).observe(hasKeysEl, { attributes: true, attributeFilter: ['style'] });
    }
  })();
  </script>
</body>
</html>
